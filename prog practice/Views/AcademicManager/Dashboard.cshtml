﻿@{
    ViewData["Title"] = "Academic Manager Dashboard";
    var recentDecisions = ViewData["RecentDecisions"] as List<prog_practice.Models.Claim>;
}

<div class="container mt-4">

    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
        <h4 class="mb-0">Welcome, Academic Manager</h4>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item active" aria-current="page">Manager Dashboard</li>
            </ol>
        </nav>
    </div>

    <!-- Quick Access -->
    <div class="card shadow-sm rounded-3 mb-4">
        <div class="card-body">
            <h4 class="card-title mb-3 text-dark">Quick Access</h4>
            <div class="d-flex flex-wrap gap-3">
                <a asp-controller="AcademicManager" asp-action="Claims" class="btn btn-primary">
                    Finalise Pending Claims
                </a>
                <a href="@Url.Action("FeatureComingSoon", "Home", new { featureName = "Generate Reports", userRole = "AcademicManager" })" class="btn btn-primary px-4">Generate Reports</a>
                <a href="@Url.Action("FeatureComingSoon", "Home", new { featureName = "Audit Trail", userRole = "AcademicManager" })" class="btn btn-primary px-4">Audit Trail</a>
                <a href="@Url.Action("FeatureComingSoon", "Home", new { featureName = "Help & Support", userRole = "AcademicManager" })" class="btn btn-primary px-4">Help & Support</a>
            </div>
        </div>
    </div>

    <div class="row g-4">
        <!-- Claims Status Overview -->
        <div class="col-md-6">
            <div class="card shadow-sm rounded-3 h-100">
                <div class="card-body">
                    <h4 class="card-title mb-3 text-dark">Claims Status Overview</h4>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Total Claims Submitted</span>
                            <span class="fw-bold">@ViewBag.TotalClaims</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Pending Final Approval</span>
                            <span class="badge bg-warning text-dark">@ViewBag.PendingFinalApproval</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Completed (Approved/Rejected)</span>
                            <span class="badge bg-success">@ViewBag.CompletedClaims</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Recent Approvals & Rejections -->
        <div class="col-md-6">
            <div class="card shadow-sm rounded-3 h-100">
                <div class="card-body">
                    <h4 class="card-title mb-3 text-dark">Recent Final Decisions</h4>
                    <ul class="list-group list-group-flush">
                        @if (recentDecisions != null && recentDecisions.Any())
                        {
                            foreach (var claim in recentDecisions)
                            {
                                <li class="list-group-item d-flex justify-content-between align-items-center text-dark">
                                    <span>
                                        Claim #@claim.ClaimID –
                                        <small class="text-muted">@claim.User?.FullName</small>
                                    </span>
                                    <span class="badge @(claim.ClaimStatus == "Approved" ? "bg-success" : "bg-danger")">
                                        @claim.ClaimStatus
                                    </span>
                                </li>
                            }
                        }
                        else
                        {
                            <li class="list-group-item text-center text-muted">
                                No recent final decisions available.
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <br />

    <div class="row g-4">
        <!-- Historical Records Summary -->
        <div class="col-md-6">
            <div class="card shadow-sm rounded-3">
                <div class="card-body">
                    <h4 class="card-title mb-3 text-dark">Historical Records</h4>
                    <p class="text-muted">
                        Access a complete, audit-compliant history of claims, including approvals, rejections, and manager feedback.
                    </p>
                    <a href="@Url.Action("FeatureComingSoon", "Home", new { featureName = "View All Records", userRole = "AcademicManager" })" class="btn btn-outline-primary">View All Records</a>
                </div>
            </div>
        </div>

        <!-- Audit Trail -->
        <div class="col-md-6">
            <div class="card shadow-sm rounded-3">
                <div class="card-body">
                    <h4 class="card-title mb-3 text-dark">Audit Trail</h4>
                    <p class="text-muted">
                        Track all actions taken by coordinators and academic managers to ensure full transparency.
                    </p>
                    <a href="@Url.Action("FeatureComingSoon", "Home", new { featureName = "Access Audit Trail", userRole = "AcademicManager" })" class="btn btn-outline-primary">Access Audit Trail</a>
                </div>
            </div>
        </div>
    </div>
</div>